<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Konfigurator krzese≈Ç - Fajne Krzes≈Ça (iOS Test)</title>
  <link rel="icon" href="icons/favicon.png" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f0f0f0;
      /* Force mobile viewport */
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
    }

    .container {
      max-width: 100%;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      padding: 20px;
      background: white;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .title { color: #333; font-size: 24px; margin: 0; }
    .subtitle { color: #666; margin: 10px 0 20px; }

    .detection-box {
      background: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .detection-line {
      font-family: monospace;
      font-size: 12px;
      margin: 5px 0;
      color: #333;
    }

    .detection-label { font-weight: bold; color: #666; }
    .detection-value { color: #007AFF; }

    .ios-specific {
      background: #e8f5e8;
      border: 2px solid #4CAF50;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-good { background: #4CAF50; }
    .status-warning { background: #FF9800; }
    .status-error { background: #F44336; }

    .actions {
      text-align: center;
      margin-top: 30px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin: 10px;
      text-decoration: none;
      display: inline-block;
      min-width: 160px;
    }

    .btn-primary {
      background: #007AFF;
      color: white;
    }

    .btn-secondary {
      background: #F5C842;
      color: #333;
    }

    .btn-danger {
      background: #f44336;
      color: white;
    }

    .description {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .configurator-container {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border: 2px solid #F5C842;
    }

    .configurator-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin: 0 0 15px 0;
      text-align: center;
    }
  </style>
  <script src="ios-fallback.js?v=2025080912"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="title">üì± Konfigurator krzese≈Ç - iOS</h1>
      <p class="subtitle">Dedykowana wersja mobilna dla urzƒÖdze≈Ñ iOS (iPhone XR, iPhone, iPad)</p>
    </div>

    <div class="description">
      <h2>üöÄ Wersja mobilna - iOS</h2>
      <p>Ta strona jest zoptymalizowana dla urzƒÖdze≈Ñ iOS z Safari.</p>
      <p>Gdy otworzy siƒô ta strona, oznacza to ≈ºe detekcja urzƒÖdzenia dzia≈Ça prawid≈Çowo!</p>

      <div style="margin: 20px 0; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px; border: 1px solid #4CAF50;">
        <div style="display: flex; align-items: center; margin-bottom: 10px;">
          <span class="status-indicator status-good"></span>
          <strong>UrzƒÖdzenie wykryte</strong>
        </div>
        <p style="margin: 0; color: #2E7D32;">Rozpoznano urzƒÖdzenie iOS - za≈Çadowana zosta≈Ça mobilna wersja konfiguratora.</p>
      </div>
    </div>

    <div class="detection-box">
      <h3>üì± Szczeg√≥≈Çy urzƒÖdzenia:</h3>
      <div id="detection-info">
        <!-- Detection results will be filled by JavaScript -->
      </div>
    </div>

    <!-- MOBILE CONFIGURATOR UI -->
    <div class="configurator-container">
      <h3 class="configurator-title">ü™ë Konfigurator Krzese≈Ç - Tryb Mobilny</h3>

      <!-- Category buttons -->
      <div style="margin-bottom: 20px;">
        <h4 style="margin: 0 0 10px 0; color: #555;">Wybierz kategoriƒô:</h4>
        <div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;">
          <button onclick="selectMobileCategory('Wszystkie')" style="padding: 10px 16px; background: #F5C842; border: none; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer;">Wszystkie</button>
          <button onclick="selectMobileCategory('Krzes≈Ça')" style="padding: 10px 16px; background: white; border: 2px solid #ddd; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer;">Krzes≈Ça</button>
          <button onclick="selectMobileCategory('Fotele')" style="padding: 10px 16px; background: white; border: 2px solid #ddd; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer;">Fotele</button>
          <button onclick="selectMobileCategory('Hokery')" style="padding: 10px 16px; background: white; border: 2px solid #ddd; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer;">Hokery</button>
        </div>

        <!-- Models grid -->
        <div id="mobile-models-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; margin-top: 20px; padding: 10px; background: #f9f9f9; border-radius: 8px;">
          <div style="text-align: center; padding: 20px; color: #666;">≈Åadowanie krzese≈Ç...</div>
        </div>
      </div>
    </div>

    <div class="actions">
      <a href="index_mobile_simple.html" class="btn btn-primary">‚Üí Prosta wersja mobilna</a><br>
      <a href="index.html" class="btn btn-secondary">‚Üí Wersja desktopowa (pe≈Çny funkcjonalno≈õƒá)</a><br>
      <a href="javascript:history.back()" class="btn btn-danger">‚Üê Powr√≥t</a>
    </div>
  </div>

  <script>
    // Enhanced iOS detection and debugging
    function detectIOSDevice() {
      const ua = navigator.userAgent || '';
      const platform = navigator.platform || '';
      const maxTouchPoints = navigator.maxTouchPoints || 0;

      // Comprehensive iOS detection
      const isiOS_UA = /iPhone|iPad|iPod/i.test(ua);
      const isiOS_Platform = platform === 'MacIntel' && maxTouchPoints > 1;
      const isiOS_WebKit = /WebKit/i.test(ua) && !/Chrome/i.test(ua);
      const isiOS_Version = /Version\/[\d\.]+.*Safari/i.test(ua);

      const isiOS = isiOS_UA || isiOS_Platform;
      const isiPhoneXR = isiOS && /iPhone\s+11,8|iPhone\s+9,3/i.test(ua) &&
                         (screen.width === 828 || screen.width === 750) ||
                         (isiOS && /OS 18_/i.test(ua) && window.innerWidth >= 896);

      return {
        isiOS,
        isiPhoneXR,
        isiOS_UA,
        isiOS_Platform,
        isiOS_WebKit,
        isiOS_Version,
        ua: ua.substring(0, 100),
        platform,
        maxTouchPoints,
        screenWidth: screen.width,
        screenHeight: screen.height,
        windowWidth: window.innerWidth,
        windowHeight: window.innerHeight
      };
    }

    function updateDetectionInfo() {
      const detection = detectIOSDevice();
      const detectionInfo = document.getElementById('detection-info');

      const lines = [
        `<div class="detection-line"><span class="detection-label">UrzƒÖdzenie iOS:</span> <span class="detection-value">${detection.isiOS ? 'TAK' : 'NIE'}</span></div>`,
        `<div class="detection-line"><span class="detection-label">iPhone XR:</span> <span class="detection-value">${detection.isiPhoneXR ? 'TAK' : 'NIE'}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Model:</span> <span class="detection-value">${detection.isiPhoneXR ? 'iPhone XR' : (detection.isiOS ? 'iPhone/iPad' : 'Nieznany')}</span></div>`,
        `<div class="detection-line"><span class="detection-label">User Agent:</span> <span class="detection-value">${detection.ua}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Platform:</span> <span class="detection-value">${detection.platform}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Touch Points:</span> <span class="detection-value">${detection.maxTouchPoints}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Rozmiar okna:</span> <span class="detection-value">${detection.windowWidth}x${detection.windowHeight}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Rozmiar ekranu:</span> <span class="detection-value">${detection.screenWidth}x${detection.screenHeight}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Safari:</span> <span class="detection-value">${detection.isiOS_WebKit ? 'TAK' : 'NIE'}</span></div>`,
        `<div class="detection-line"><span class="detection-label">Wersja iOS:</span> <span class="detection-value">${detection.isiOS_Version || 'Nieznana'}</span></div>`
      ];

      detectionInfo.innerHTML = lines.join('');

      // Add status indicator
      const statusDiv = document.createElement('div');
      statusDiv.style.cssText = 'margin-top: 15px; padding: 10px; background: rgba(76, 175, 80, 0.1); border-radius: 8px; border: 1px solid #4CAF50; text-align: center;';
      statusDiv.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 5px;">
          <span class="status-indicator status-good"></span>
          <strong style="color: #2E7D32;">Konfigurator mobilny za≈Çadowany</strong>
        </div>
        <p style="margin: 0; color: #2E7D32; font-size: 14px;">UrzƒÖdzenie zosta≈Ço wykryte poprawnie. Wersja mobilna dzia≈Ça w trybie pe≈Çnym.</p>
      `;
      detectionInfo.appendChild(statusDiv);
    }

    // Mobile category selection
    function selectMobileCategory(category) {
      console.log(`üì± Selected category: ${category}`);

      // Update button styles
      document.querySelectorAll('.mobile-category-btn').forEach(btn => {
        if (btn.textContent === category) {
          btn.style.background = '#F5C842';
          btn.style.color = '#333';
          btn.style.border = '2px solid #F5C842';
        } else {
          btn.style.background = 'white';
          btn.style.color = '#333';
          btn.style.border = '2px solid #ddd';
        }
      });

      // Load models for category
      loadMobileModels(category);
    }

    // Load mobile models
    function loadMobileModels(category) {
      const modelsGrid = document.getElementById('mobile-models-grid');

      modelsGrid.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">≈Åadowanie modeli...</div>';

      // Simulate loading - in real implementation this would load from data
      setTimeout(() => {
        const sampleModels = [
          { Nazwa: 'Tulla', Kategoria: 'Krzes≈Ça', Ikona: 'icons/chair_icon.png', Cena: '450' },
          { Nazwa: 'Soul', Kategoria: 'Krzes≈Ça', Ikona: 'icons/chair_icon.png', Cena: '520' },
          { Nazwa: 'Fargo', Kategoria: 'Krzes≈Ça', Ikona: 'icons/chair_icon.png', Cena: '380' },
          { Nazwa: 'Jakob', Kategoria: 'Fotele', Ikona: 'icons/chair_icon.png', Cena: '850' },
          { Nazwa: 'Molly', Kategoria: 'Hokery', Ikona: 'icons/hooker_icon.png', Cena: '320' }
        ];

        const filteredModels = category === 'Wszystkie'
          ? sampleModels
          : sampleModels.filter(model => model.Kategoria === category);

        modelsGrid.innerHTML = '';

        filteredModels.forEach(model => {
          const modelElement = document.createElement('div');
          modelElement.className = 'mobile-model-item';
          modelElement.style.cssText = `
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #f0f0f0;
          `;

          modelElement.innerHTML = `
            <img src="${model.Ikona}" alt="${model.Nazwa}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; margin-bottom: 10px;">
            <div style="font-size: 16px; font-weight: 600; color: #333; margin-bottom: 5px;">${model.Nazwa}</div>
            <div style="font-size: 14px; color: #F5C842; font-weight: bold;">${model.Cena} z≈Ç</div>
          `;

          modelElement.addEventListener('click', () => {
            console.log(`üì± Mobile model selected: ${model.Nazwa}`);
            alert(`Wybrano model: ${model.Nazwa}\nCena: ${model.Cena} z≈Ç\n\nKonfiguracja jest dostƒôpna w pe≈Çnej wersji webowej.`);
            // In full implementation, this would navigate to the configuration screen
          });

          modelElement.addEventListener('mouseenter', () => {
            modelElement.style.transform = 'translateY(-2px)';
            modelElement.style.borderColor = '#F5C842';
          });

          modelElement.addEventListener('mouseleave', () => {
            modelElement.style.transform = 'translateY(0)';
            modelElement.style.borderColor = '#f0f0f0';
          });

          modelsGrid.appendChild(modelElement);
        });

        console.log(`üì± Loaded ${filteredModels.length} models for category: ${category}`);
      }, 500);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateDetectionInfo();
      loadMobileModels('Wszystkie'); // Load all models initially

      console.log('üì± iOS Mobile Test Page initialized');
      console.log('üì± Detection results:', detectIOSDevice());

      // Monitor for fallback UI if loaded
      setInterval(() => {
        if (document.getElementById('ios-fallback-ui')) {
          console.log('‚úÖ iOS Fallback UI detected on mobile test page');
          updateDetectionInfo();
        }
      }, 2000);
    });

    // Update on resize
    window.addEventListener('resize', () => {
      setTimeout(updateDetectionInfo, 500);
    });
  </script>
</body>
</html>
